<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Daten darstellen | R - KfN 11.12.20</title>
  <meta name="description" content="Kurze Einführung in den Umgang mit R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Daten darstellen | R - KfN 11.12.20" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Kurze Einführung in den Umgang mit R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Daten darstellen | R - KfN 11.12.20" />
  
  <meta name="twitter:description" content="Kurze Einführung in den Umgang mit R" />
  

<meta name="author" content="Max Brede" />


<meta name="date" content="2020-12-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="daten-einlesen.html"/>
<link rel="next" href="appendix.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="/home/brede/MEGA/Honorar/111220_KfN/styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R - KfN <br> 11.12.20</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Vorwort</a></li>
<li class="chapter" data-level="" data-path="rste-schritte.html"><a href="rste-schritte.html"><i class="fa fa-check"></i>Rste Schritte</a>
<ul>
<li class="chapter" data-level="" data-path="rste-schritte.html"><a href="rste-schritte.html#warum-r"><i class="fa fa-check"></i>Warum R?</a></li>
<li class="chapter" data-level="" data-path="rste-schritte.html"><a href="rste-schritte.html#r-syntax-basics"><i class="fa fa-check"></i>R-Syntax Basics</a></li>
<li class="chapter" data-level="" data-path="rste-schritte.html"><a href="rste-schritte.html#datenformate-in-r"><i class="fa fa-check"></i>Datenformate in R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="daten-manipulieren.html"><a href="daten-manipulieren.html"><i class="fa fa-check"></i>Daten manipulieren</a>
<ul>
<li class="chapter" data-level="" data-path="daten-manipulieren.html"><a href="daten-manipulieren.html#datensätze-in-r"><i class="fa fa-check"></i>Datensätze in R</a></li>
<li class="chapter" data-level="" data-path="daten-manipulieren.html"><a href="daten-manipulieren.html#regressionen-in-r"><i class="fa fa-check"></i>Regressionen in R</a></li>
<li class="chapter" data-level="" data-path="daten-manipulieren.html"><a href="daten-manipulieren.html#aufgaben-teil-1"><i class="fa fa-check"></i>Aufgaben Teil 1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="daten-einlesen.html"><a href="daten-einlesen.html"><i class="fa fa-check"></i>Daten einlesen</a>
<ul>
<li class="chapter" data-level="" data-path="daten-einlesen.html"><a href="daten-einlesen.html#einlesen-von-daten"><i class="fa fa-check"></i>Einlesen von Daten</a></li>
<li class="chapter" data-level="" data-path="daten-einlesen.html"><a href="daten-einlesen.html#datenaufbereitung"><i class="fa fa-check"></i>Datenaufbereitung</a></li>
<li class="chapter" data-level="" data-path="daten-einlesen.html"><a href="daten-einlesen.html#zusammenführen-von-datensätzen"><i class="fa fa-check"></i>Zusammenführen von Datensätzen</a></li>
<li class="chapter" data-level="" data-path="daten-einlesen.html"><a href="daten-einlesen.html#aufgaben-teil-2"><i class="fa fa-check"></i>Aufgaben Teil 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="daten-darstellen.html"><a href="daten-darstellen.html"><i class="fa fa-check"></i>Daten darstellen</a>
<ul>
<li class="chapter" data-level="" data-path="daten-darstellen.html"><a href="daten-darstellen.html#pivotieren-von-datensätzen"><i class="fa fa-check"></i>pivotieren von Datensätzen</a></li>
<li class="chapter" data-level="" data-path="daten-darstellen.html"><a href="daten-darstellen.html#ggplot2"><i class="fa fa-check"></i>ggplot2</a></li>
<li class="chapter" data-level="" data-path="daten-darstellen.html"><a href="daten-darstellen.html#aufgaben-teil-3"><i class="fa fa-check"></i>Aufgaben Teil 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#nützliche-pakete"><i class="fa fa-check"></i>Nützliche Pakete</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#andere-ressourcen"><i class="fa fa-check"></i>Andere Ressourcen</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="literatur.html"><a href="literatur.html"><i class="fa fa-check"></i>Literatur</a></li>
<li class="divider"></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Lizenzvertrag" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R - KfN 11.12.20</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="daten-darstellen" class="section level1">
<h1>Daten darstellen</h1>
<div id="pivotieren-von-datensätzen" class="section level2">
<h2>pivotieren von Datensätzen</h2>
<p>
Als Vorbereitung auf die Darstellung von Daten brauchen wir noch eine Funktion.
</p>
<p>
Für das Grafikpaket, das wir benutzen wollen, müssen die Daten im <code>long format</code> vorliegen. Das heißt, dass jede Variable eine Spalte und jede Zeile eine Beobachtung darstellt.
</p>
<p>Insbesondere müssen wir darauf achten, dass alle Werte, die wir zum Beispiel an einer Achse darstellen wollen in einer Variable vorliegen. <br></p>
<!-- ### Vorbereitung zum Pivotieren -->
<p>Als Beispiel wollen wir den <code>'crime'</code>-Datensatz pivotieren. Um das ganze übersichtlicher zu halten, bereiten wir den Datensatz aber noch ein bisschen vor.</p>
<p>Wir wollen dafür</p>
<ol style="list-style-type: decimal">
<li>Den Datensatz einlesen</li>
<li>Die Spalten <code>Force</code>, <code>HOMICIDE</code>, <code>Attempted murder</code>, <code>Violence with injury</code> und <code>Assault with injury</code> einlesen.</li>
<li>Die Mord-Spalte so umbenennen, dass der Name in das restliche Schema passt.</li>
<li>Die <code>Total</code>-Zeile ausschließen.</li>
</ol>
<!-- ### Vorbereitung zum Pivotieren -->
<p class="q">
Wie machen wir das?
</p>
<div class="build">
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="daten-darstellen.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb125-2"><a href="daten-darstellen.html#cb125-2" aria-hidden="true" tabindex="-1"></a>crime <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;data/crime_plot.csv&quot;</span>, </span>
<span id="cb125-3"><a href="daten-darstellen.html#cb125-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;;&quot;</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb125-4"><a href="daten-darstellen.html#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Force,HOMICIDE,Country,<span class="st">`</span><span class="at">Attempted murder</span><span class="st">`</span>, </span>
<span id="cb125-5"><a href="daten-darstellen.html#cb125-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Violence with injury</span><span class="st">`</span>, <span class="st">`</span><span class="at">Assault with injury</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb125-6"><a href="daten-darstellen.html#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;Homicide&#39;</span> <span class="ot">=</span> <span class="st">&#39;HOMICIDE&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb125-7"><a href="daten-darstellen.html#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Force <span class="sc">!=</span> <span class="st">&#39;Total&#39;</span>)</span>
<span id="cb125-8"><a href="daten-darstellen.html#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(crime)</span></code></pre></div>
<pre><code>## Rows: 44
## Columns: 6
## $ Force                  &lt;chr&gt; &quot;Avon and Somers…
## $ Homicide               &lt;dbl&gt; 10, 4, 1, 7, 3, …
## $ Country                &lt;chr&gt; &quot;England&quot;, &quot;Engl…
## $ `Attempted murder`     &lt;dbl&gt; 20, 10, 3, 13, 6…
## $ `Violence with injury` &lt;dbl&gt; 9293, 4368, 2200…
## $ `Assault with injury`  &lt;dbl&gt; 8716, 4171, 1905…</code></pre>
</div>
<!-- ### pivotieren von Datensätzen -->
<p>Um den Datensatz in ein längeres Format zu pivotieren, benutzen wir die <code>pivot_longer</code>-Funktion.
Wir erstellen dafür hier einen zweiten Datensatz</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="daten-darstellen.html#cb127-1" aria-hidden="true" tabindex="-1"></a>crime_long <span class="ot">&lt;-</span> crime <span class="sc">%&gt;%</span> </span>
<span id="cb127-2"><a href="daten-darstellen.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb127-3"><a href="daten-darstellen.html#cb127-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&#39;Homicide&#39;</span>,<span class="st">&#39;Attempted murder&#39;</span>, </span>
<span id="cb127-4"><a href="daten-darstellen.html#cb127-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">&#39;Violence with injury&#39;</span>, <span class="st">&#39;Assault with injury&#39;</span>),</span>
<span id="cb127-5"><a href="daten-darstellen.html#cb127-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&#39;offence&#39;</span>, </span>
<span id="cb127-6"><a href="daten-darstellen.html#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&#39;count&#39;</span>)</span>
<span id="cb127-7"><a href="daten-darstellen.html#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(crime_long)</span></code></pre></div>
<pre><code>## Rows: 176
## Columns: 4
## $ Force   &lt;chr&gt; &quot;Avon and Somerset&quot;, &quot;Avon and …
## $ Country &lt;chr&gt; &quot;England&quot;, &quot;England&quot;, &quot;England&quot;…
## $ offence &lt;chr&gt; &quot;Homicide&quot;, &quot;Attempted murder&quot;,…
## $ count   &lt;dbl&gt; 10, 20, 9293, 8716, 4, 10, 4368…</code></pre>
<div id="vorbereitung-für-die-grafische-darstellung" class="section level3">
<h3>Vorbereitung für die grafische Darstellung</h3>
<p>Abschließend fügen wir noch für später Auswertungen eine Variable hinzu, die codiert, ob die Straftat in einer Verletzung ausgegangen ist oder versuchter/erfolgreicher Mord ist. Dafür benutzen wir die <code>str_detect</code>-Funktion.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="daten-darstellen.html#cb129-1" aria-hidden="true" tabindex="-1"></a>crime_long <span class="ot">&lt;-</span> crime_long <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="daten-darstellen.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type_of_offence =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(offence, <span class="st">&#39;injury&#39;</span>),</span>
<span id="cb129-3"><a href="daten-darstellen.html#cb129-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&#39;injury&#39;</span>,</span>
<span id="cb129-4"><a href="daten-darstellen.html#cb129-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&#39;(attempted) homicide&#39;</span>))</span>
<span id="cb129-5"><a href="daten-darstellen.html#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(crime)</span></code></pre></div>
<pre><code>## Rows: 44
## Columns: 6
## $ Force                  &lt;chr&gt; &quot;Avon and Somers…
## $ Homicide               &lt;dbl&gt; 10, 4, 1, 7, 3, …
## $ Country                &lt;chr&gt; &quot;England&quot;, &quot;Engl…
## $ `Attempted murder`     &lt;dbl&gt; 20, 10, 3, 13, 6…
## $ `Violence with injury` &lt;dbl&gt; 9293, 4368, 2200…
## $ `Assault with injury`  &lt;dbl&gt; 8716, 4171, 1905…</code></pre>
</div>
<div id="aufgabe-1-4" class="section level3">
<h3>Aufgabe 1</h3>
<p>Lesen Sie die zwei in den letzten Aufgaben abgespeicherten ‘temp_covid.csv’ und ‘chart_overview.csv’ ein.</p>
<p>Entfernen Sie zuerst die Platzierungs-Spalte aus dem Chart-Datensatz.</p>
<p>Legen Sie dann einen Vektor mit den Namen der 5 erfolgreichsten Songs über das ganze Jahr an. Berechnen Sie dafür zuerst den Summen-Score pro Song.</p>
<p>Die nächsten, grau hinterlegten Schritte sind etwas fortgeschritten, Sie können sie überspringen indem Sie den ‘chart_top5.csv’-Datensatz einlesen.</p>
<div style="background-color: #eeeeee;">
<p>Mit der <code>arrange</code>-Funktion können Sie sich dann die Songs nach Erfolg sortieren lassen. Probieren Sie die ersten beiden Beispiele auf der Hilfeseite aus um ein Gefühl für die nötige Funktion zu bekommen.</p>
<p>Die 5 erfolgreichsten Songs können Sie sich dann per Indizierung ausgeben lassen.</p>
<p>Nutzen Sie im nächsten Schritt den erstellten Vektor um den Chart-Datensatz zu filtern. Lesen Sie dafür den Hilfe-Eintrag des <code>%in%</code>-Operators.</p>
<p>Pivotieren Sie den Datensatz abschließend derart, dass jedem der Songs eine Spalte zugeordnet ist. Lesen Sie dazu die Hilfeseite der <code>pivot_wider</code>-Funktion.</p>
</div>
<p>Fügen Sie den Datensatz anschließend dem Covid-Temperatur-Datensatz an. Alle Zeilen aus dem Covid-Temperatur-Datensatz sollen erhalten bleiben.</p>
<p>Standardisieren Sie anschließend die mittlere Temperatur und die neuen Fälle derart, dass sie sich auch in ienem Bereich zwischen 0 und 1 bewegen.</p>
<p>Pivotieren Sie den gesamten Datensatz zum Schluss ins long-Format, so dass eine Spalte mit der Kalenderwoche, eine Spalte mit dem Variablennamen und eine Spalte mit den Chart-Scores übrigbleibt.</p>
</div>
</div>
<div id="ggplot2" class="section level2">
<h2>ggplot2</h2>
<p>
Eins der stärksten Argumente für die Benutzung von R und dem <code>tidyverse</code> ist das Grafik-Paket <code>ggplot2</code>.
</p>
<div class="build">
<p>
Mit ein bisschen Gewöhnung macht <code>ggplot2</code> es sehr einfach, hübsche Grafiken zu erstellen.
</p>
<p>Die Syntax für <code>ggplot2</code> ist dabei aber ein bisschen anders als die, die wir bisher von R gewohnt sind.</p>
<p>
Dafür müssen wir zuerst eine Grundebene erstellen, auf die wir die Grafik anschließend layern können.
</p>
<p>
Diese Grundebene kann man sich ein bisschen wie eine leere Leinwand vorstellen.
Dabei wird beim Erstellen der ‘Leinwand’ direkt festgelegt, auf welchen Daten die Abbildung basieren soll und welche Variablen wie dargestellt werden sollen.
</p>
</div>
<!-- ### ggplot2 -->
<p>
Diese Leinwand erstellt man mit der <code>ggplot</code>-Funktion, in die man, wie in die meisten <code>tidyverse</code>-Funktionen, pipen kann.
</p>
<p>
Als zweites Argument nach dem Datensatz erwartet <code>ggplot</code> eine Angabe, wie welche Variablen dargestellt werden sollen. Diese Angaben <em>müssen</em> mit <code>aes</code> für aesthetics erstellt werden:
</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="daten-darstellen.html#cb131-1" aria-hidden="true" tabindex="-1"></a>crime_plot <span class="ot">&lt;-</span> crime <span class="sc">%&gt;%</span> </span>
<span id="cb131-2"><a href="daten-darstellen.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Homicide, <span class="at">y =</span> <span class="st">`</span><span class="at">Attempted murder</span><span class="st">`</span>))</span></code></pre></div>
<!-- ### ggplot2 {.scrollable} -->
<p>Diese ‘leere Leinwand’ sieht so aus:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="daten-darstellen.html#cb132-1" aria-hidden="true" tabindex="-1"></a>crime_plot</span></code></pre></div>
<p><img src="R_Einfuehrung_111220_files/figure-html/unnamed-chunk-98-1.png" width="1000px" style="display: block; margin: auto;" /></p>
<div id="aesthetics" class="section level3 subsection">
<h3>aesthetics</h3>
<p>Auf diese Leinwand können wir dann eine Reihe von verschiedenen grafischen Elementen legen, den so genannten <code>geom</code>s. Das einfachste Beispiel auf der eben erstellten Leinwand ist ein Scatterplot.
Um der Leinwand Punkte hinzuzufügen, <em>addieren</em> wir einfach einen <code>geom_point</code>-Layer auf die Grafik:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="daten-darstellen.html#cb133-1" aria-hidden="true" tabindex="-1"></a>crime_plot <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="imgs/pts.png" width="1000px" style="display: block; margin: auto;" /></p>
<!-- ### aesthetics -->
<p>
Dieser sehr einfache Graph ist aber natürlich nicht alles. Die <code>aes</code>- und die <code>ggplot</code>-Funktionen können noch eine ganze Reihe an weiteren grafischen Parametern annehmen.
</p>
<p>
Die für unseren Graphen attraktivsten sind:
</p>
<ul>
<li><code>size</code> - für die Punktgröße</li>
<li><code>color</code> - für die Farbe der Punkte</li>
<li><code>shape</code> - für die Wahl der Symbole</li>
</ul>
<!-- ### aesthetics -->
<p>Jedes <code>geom</code> hat auch die Möglichkeit, Daten und <code>aesthetics</code> zu nehmen. Wenn keine gesetzt werden, werden einfach die des ursprünglichen <code>ggplot</code>-Aufrufs übernommen.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="daten-darstellen.html#cb134-1" aria-hidden="true" tabindex="-1"></a>crime_plot <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="st">`</span><span class="at">Violence with injury</span><span class="st">`</span>, </span>
<span id="cb134-2"><a href="daten-darstellen.html#cb134-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">color =</span> <span class="st">`</span><span class="at">Assault with injury</span><span class="st">`</span>))</span></code></pre></div>
<p><img src="imgs/pts2.png" width="1000px" style="display: block; margin: auto;" /></p>
<p class="o">
Die aus mehreren Worten bestehenden Variablennamen sind mit Gravis eingeschlossen, nicht mit Anführungszeichen!
</p>
<!-- ### aesthetics -->
<p>Wenn <code>aesthetic</code>-Argumente außerhalb der <code>aes</code>-Funktion gesetzt werden, geben sie einen konstanten Wert für das <code>geom</code> an:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="daten-darstellen.html#cb135-1" aria-hidden="true" tabindex="-1"></a>crime_plot <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="st">`</span><span class="at">Violence with injury</span><span class="st">`</span>), </span>
<span id="cb135-2"><a href="daten-darstellen.html#cb135-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">color =</span> <span class="st">&#39;purple&#39;</span>)</span></code></pre></div>
<p><img src="imgs/pts3.png" width="1000px" style="display: block; margin: auto;" /></p>
</div>
<div id="geoms" class="section level3 subsection">
<h3>geoms</h3>
<p>
Um andere Grafiken zu erstellen, ersetzt man einfach das <code>geom_point</code>-geom durch ein anderes.
</p>
<p>
Dabei kann es natürlich nötig sein, eine andere Leinwand zu definieren.
</p>
<!-- ### geoms{.scrollable} -->
<p>
Histogramme, Boxplots und Barcharts:<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>
</p>
<div class="cols">
<div class="col">
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="daten-darstellen.html#cb136-1" aria-hidden="true" tabindex="-1"></a>crime <span class="sc">%&gt;%</span> </span>
<span id="cb136-2"><a href="daten-darstellen.html#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Homicide)) <span class="sc">+</span></span>
<span id="cb136-3"><a href="daten-darstellen.html#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb136-4"><a href="daten-darstellen.html#cb136-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb136-5"><a href="daten-darstellen.html#cb136-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="dv">3</span>)</span></code></pre></div>
</div>
<div class="col">
<p><img src="imgs/pts4.png" width="1000px" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="cols">
<div class="col">
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="daten-darstellen.html#cb137-1" aria-hidden="true" tabindex="-1"></a>crime_long <span class="sc">%&gt;%</span> </span>
<span id="cb137-2"><a href="daten-darstellen.html#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> count, </span>
<span id="cb137-3"><a href="daten-darstellen.html#cb137-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> offence)) <span class="sc">+</span></span>
<span id="cb137-4"><a href="daten-darstellen.html#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
</div>
<div class="col">
<p><img src="imgs/pts5.png" width="1000px" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="cols">
<div class="col">
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="daten-darstellen.html#cb138-1" aria-hidden="true" tabindex="-1"></a>crime_long <span class="sc">%&gt;%</span></span>
<span id="cb138-2"><a href="daten-darstellen.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> count,</span>
<span id="cb138-3"><a href="daten-darstellen.html#cb138-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> offence</span>
<span id="cb138-4"><a href="daten-darstellen.html#cb138-4" aria-hidden="true" tabindex="-1"></a>             )) <span class="sc">+</span></span>
<span id="cb138-5"><a href="daten-darstellen.html#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
</div>
<div class="col">
<p><img src="imgs/pts6.png" width="1000px" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="aufgabe-2-3" class="section level3">
<h3>Aufgabe 2</h3>
<p>Für die Darstellung ist der standardisierte long-Format-Datensatz aus der letzten Aufgabe nötig.</p>
<p>Sollten Sie nicht ganz zum Ende der Aufgabe gekommen sein, können Sie auch den <code>darst_aufg_1.csv</code>-Datensatz einlesen.</p>
<p>Erstellen Sie den folgenden Graphen:</p>
<p><img src="imgs/task_ts.png" width="1000px" style="display: block; margin: auto;" /></p>
<p>Finden Sie dafür im Hilfe-Eintrag der <code>theme</code>- Funktion heraus, wie Sie die Position der Legende verändern können und im Hilfeeintrag der <code>labs</code>-Funktion wie Sie die Beschriftungen anpassen können.</p>
</div>
<div id="finetuning" class="section level3 subsection">
<h3>finetuning</h3>
<p>
Der Barchart ist ein guter Anlass, den Plot zu optimieren.
</p>
<p>
Uns stehen die folgenden Informationen zur Verfügung:
</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="daten-darstellen.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(crime_long)</span></code></pre></div>
<pre><code>## Rows: 176
## Columns: 5
## $ Force           &lt;chr&gt; &quot;Avon and Somerset&quot;, &quot;A…
## $ Country         &lt;chr&gt; &quot;England&quot;, &quot;England&quot;, &quot;…
## $ offence         &lt;chr&gt; &quot;Homicide&quot;, &quot;Attempted …
## $ count           &lt;dbl&gt; 10, 20, 9293, 8716, 4, …
## $ type_of_offence &lt;chr&gt; &quot;(attempted) homicide&quot;,…</code></pre>
<p>Um ein bisschen mehr Spielraum zu haben, gibt es in <code>ggplot</code> <code>facets</code>.</p>
</div>
<div id="facets" class="section level3">
<h3>facets!</h3>
<p>Facets lassen uns einfach mehrere Subplots definieren, um zusätzlich zu den in unseren <code>geom</code>s und <code>aes</code>-Aufrufen definierten Aspekten Subgruppen darzustellen.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="daten-darstellen.html#cb141-1" aria-hidden="true" tabindex="-1"></a>crime_long <span class="sc">%&gt;%</span>  </span>
<span id="cb141-2"><a href="daten-darstellen.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> count,</span>
<span id="cb141-3"><a href="daten-darstellen.html#cb141-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> Force)) <span class="sc">+</span></span>
<span id="cb141-4"><a href="daten-darstellen.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb141-5"><a href="daten-darstellen.html#cb141-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb141-6"><a href="daten-darstellen.html#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(offence<span class="sc">~</span>Country, <span class="do">## als facets mit Straftat in Zeilen und Landesteil in Spalten</span></span>
<span id="cb141-7"><a href="daten-darstellen.html#cb141-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="do">## mit individuellen Skalen</span></span></code></pre></div>
<p><img src="R_Einfuehrung_111220_files/figure-html/unnamed-chunk-113-1.png" width="1000px" style="display: block; margin: auto;" /></p>
<p class="q">
Wie können wir das noch verbessern?
</p>
</div>
<div id="additional-tweeks" class="section level3">
<h3>additional tweeks</h3>
<p>Zuerst sortieren wir die Polizeistationen in absteigender Reihenfolge der jeweiligen mittleren Fallzahlen.</p>
<p>Dafür benutzen wir das <code>forcats</code>-Paket aus dem <code>tidyverse</code>. Ein Paket, dass Funktionen zum Verändern und Sortieren von Faktoren bietet.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="daten-darstellen.html#cb142-1" aria-hidden="true" tabindex="-1"></a>crime_long <span class="sc">%&gt;%</span> </span>
<span id="cb142-2"><a href="daten-darstellen.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb142-3"><a href="daten-darstellen.html#cb142-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">Force =</span> <span class="fu">as_factor</span>(Force), <span class="do">## zuerst in Faktor umwandeln</span></span>
<span id="cb142-4"><a href="daten-darstellen.html#cb142-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">Force =</span> <span class="fu">fct_reorder</span>(Force, count,<span class="at">.fun =</span> mean, <span class="at">.desc =</span> T)) <span class="sc">%&gt;%</span> <span class="do">## dann absteigend sortieren</span></span>
<span id="cb142-5"><a href="daten-darstellen.html#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> count,</span>
<span id="cb142-6"><a href="daten-darstellen.html#cb142-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> Force)) <span class="sc">+</span></span>
<span id="cb142-7"><a href="daten-darstellen.html#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb142-8"><a href="daten-darstellen.html#cb142-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb142-9"><a href="daten-darstellen.html#cb142-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(offence<span class="sc">~</span>Country, </span>
<span id="cb142-10"><a href="daten-darstellen.html#cb142-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>)</span></code></pre></div>
<p><img src="R_Einfuehrung_111220_files/figure-html/unnamed-chunk-114-1.png" width="1000px" style="display: block; margin: auto;" /></p>
<!-- ### additional tweeks -->
<p>Um die einzelnen Stationen besser lesbar zu machen, können wir noch die Achsen austauschen.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="daten-darstellen.html#cb143-1" aria-hidden="true" tabindex="-1"></a>crime_long <span class="sc">%&gt;%</span> </span>
<span id="cb143-2"><a href="daten-darstellen.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb143-3"><a href="daten-darstellen.html#cb143-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">Force =</span> <span class="fu">as_factor</span>(Force), <span class="do">## zuerst in Faktor umwandeln</span></span>
<span id="cb143-4"><a href="daten-darstellen.html#cb143-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">Force =</span> <span class="fu">fct_reorder</span>(Force, count,<span class="at">.fun =</span> mean, <span class="at">.desc =</span> T)) <span class="sc">%&gt;%</span> <span class="do">## dann absteigend sortieren</span></span>
<span id="cb143-5"><a href="daten-darstellen.html#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> count,</span>
<span id="cb143-6"><a href="daten-darstellen.html#cb143-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> Force)) <span class="sc">+</span></span>
<span id="cb143-7"><a href="daten-darstellen.html#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb143-8"><a href="daten-darstellen.html#cb143-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb143-9"><a href="daten-darstellen.html#cb143-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb143-10"><a href="daten-darstellen.html#cb143-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Country <span class="sc">~</span> offence, </span>
<span id="cb143-11"><a href="daten-darstellen.html#cb143-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>)</span></code></pre></div>
<p><img src="R_Einfuehrung_111220_files/figure-html/unnamed-chunk-115-1.png" width="1000px" style="display: block; margin: auto;" /></p>
</div>
<div id="themes" class="section level3 subsection">
<h3>themes</h3>
<p>Und zuletzt die Achsenbeschriftungen anpassen und die x-Achsen-Beschriftung rotieren.</p>
<ul>
<li><p>Die Achsenbeschriftungen und Überschriften lassen sich mit der <code>labs</code>-Funktion festlegen</p></li>
<li><p>Die Ausrichtung der Beschriftung (wie die meisten grafischen Aspekte) lassen sich mit der <code>theme</code>-Funktion fine-tunen</p></li>
</ul>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="daten-darstellen.html#cb144-1" aria-hidden="true" tabindex="-1"></a>crime_long <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="daten-darstellen.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb144-3"><a href="daten-darstellen.html#cb144-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">Force =</span> <span class="fu">as_factor</span>(Force), <span class="do">## zuerst in Faktor umwandeln</span></span>
<span id="cb144-4"><a href="daten-darstellen.html#cb144-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">Force =</span> <span class="fu">fct_reorder</span>(Force, count,<span class="at">.fun =</span> mean, <span class="at">.desc =</span> T)) <span class="sc">%&gt;%</span> <span class="do">## dann absteigend sortieren</span></span>
<span id="cb144-5"><a href="daten-darstellen.html#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> count,</span>
<span id="cb144-6"><a href="daten-darstellen.html#cb144-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> Force)) <span class="sc">+</span></span>
<span id="cb144-7"><a href="daten-darstellen.html#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb144-8"><a href="daten-darstellen.html#cb144-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb144-9"><a href="daten-darstellen.html#cb144-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb144-10"><a href="daten-darstellen.html#cb144-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Country <span class="sc">~</span> offence, </span>
<span id="cb144-11"><a href="daten-darstellen.html#cb144-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb144-12"><a href="daten-darstellen.html#cb144-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Anzahl&#39;</span>,</span>
<span id="cb144-13"><a href="daten-darstellen.html#cb144-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Polizeistation&#39;</span>,</span>
<span id="cb144-14"><a href="daten-darstellen.html#cb144-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Gemeldete Straftaten pro englischer Polizeistation&#39;</span>) <span class="sc">+</span></span>
<span id="cb144-15"><a href="daten-darstellen.html#cb144-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>,</span>
<span id="cb144-16"><a href="daten-darstellen.html#cb144-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="R_Einfuehrung_111220_files/figure-html/unnamed-chunk-116-1.png" width="1000px" style="display: block; margin: auto;" /></p>
</div>
<div id="aufgabe-3-2" class="section level3">
<h3>Aufgabe 3</h3>
<p>Nutzen Sie den Hilfe-Eintrag der <code>theme</code>-Funktion und der <code>scale_color_manual</code>-Funktion, sowie eine beliebige Anzahl an <code>aesthetics</code>, um den Graph aus der vorigen Aufgabe so sehr zu verunstalten wie Ihnen irgendwie möglich ist.</p>
</div>
<div id="grafiken-exportieren" class="section level3 subsection">
<h3>Grafiken exportieren</h3>
<p>Um die Auflösung zu verbessern können wir jetzt noch die Grafik mit anderen Seitenverhältnissen exportieren. Die <code>ggsave</code>-Funktion lässt uns einfach Grafiken in beliebigen Formaten exportieren.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="daten-darstellen.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&#39;imgs/police_stations.png&#39;</span>,</span>
<span id="cb145-2"><a href="daten-darstellen.html#cb145-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">50</span>,</span>
<span id="cb145-3"><a href="daten-darstellen.html#cb145-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">height =</span> <span class="dv">100</span>,</span>
<span id="cb145-4"><a href="daten-darstellen.html#cb145-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">units =</span> <span class="st">&#39;cm&#39;</span>)</span></code></pre></div>
<p><img src="imgs/police_stations.png" width="600px" style="display: block; margin: auto;" /></p>

<!-- # --- -->
<!-- # title: "04_Aufgaben" -->
<!-- # author: "Max Brede" -->
<!-- # date: "11.12.2020" -->
<!-- # output: html_document -->
<!-- # --- -->
<script type="text/javascript">
<!--
    function showSolution(x){
        element=document.getElementById('solution' + x)
        if(element.style.visibility=='visible'){
            element.style.visibility='hidden';
            element.style.display='none';
        }else{
            element.style.visibility="visible";
            element.style.display='block';
        }
    }

    -->

</script>
</div>
</div>
<div id="aufgaben-teil-3" class="section level2">
<h2>Aufgaben Teil 3</h2>
<div id="aufgabe-1-5" class="section level3">
<h3>Aufgabe 1</h3>
<p>Lesen Sie die zwei in den letzten Aufgaben abgespeicherten ‘temp_covid.csv’ und ‘chart_overview.csv’ ein.</p>
<p>Entfernen Sie zuerst die Platzierungs-Spalte aus dem Chart-Datensatz.</p>
<p>Legen Sie dann einen Vektor mit den Namen der 5 erfolgreichsten Songs über das ganze Jahr an. Berechnen Sie dafür zuerst den Summen-Score pro Song.</p>
<p>Die nächsten, grau hinterlegten Schritte sind etwas fortgeschritten, Sie können sie überspringen indem Sie den ‘chart_top5.csv’-Datensatz einlesen.</p>
<div style="background-color: #eeeeee;">
<p>Mit der <code>arrange</code>-Funktion können Sie sich dann die Songs nach Erfolg sortieren lassen. Probieren Sie die ersten beiden Beispiele auf der Hilfeseite aus um ein Gefühl für die nötige Funktion zu bekommen.</p>
<p>Die 5 erfolgreichsten Songs können Sie sich dann per Indizierung ausgeben lassen.</p>
<p>Nutzen Sie im nächsten Schritt den erstellten Vektor um den Chart-Datensatz zu filtern. Lesen Sie dafür den Hilfe-Eintrag des <code>%in%</code>-Operators.</p>
<p>Pivotieren Sie den Datensatz abschließend derart, dass jedem der Songs eine Spalte zugeordnet ist. Lesen Sie dazu die Hilfeseite der <code>pivot_wider</code>-Funktion.</p>
</div>
<p>Fügen Sie den Datensatz anschließend dem Covid-Temperatur-Datensatz an. Alle Zeilen aus dem Covid-Temperatur-Datensatz sollen erhalten bleiben.</p>
<p>Standardisieren Sie anschließend die mittlere Temperatur und die neuen Fälle derart, dass sie sich auch in ienem Bereich zwischen 0 und 1 bewegen.</p>
<p>Pivotieren Sie den gesamten Datensatz zum Schluss ins long-Format, so dass eine Spalte mit der Kalenderwoche, eine Spalte mit dem Variablennamen und eine Spalte mit den Chart-Scores übrigbleibt.</p>
<input type='button' value='Lösung' onclick='showSolution(1);'/>
<div id="solution1" style="visibility:hidden;display:none">
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="daten-darstellen.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb146-2"><a href="daten-darstellen.html#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="daten-darstellen.html#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="daten-darstellen.html#cb146-4" aria-hidden="true" tabindex="-1"></a>temp_covid <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;data/temp_covid.csv&#39;</span>)</span>
<span id="cb146-5"><a href="daten-darstellen.html#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="daten-darstellen.html#cb146-6" aria-hidden="true" tabindex="-1"></a>chart_overview <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&#39;data/chart_overview.csv&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb146-7"><a href="daten-darstellen.html#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span> Position) </span>
<span id="cb146-8"><a href="daten-darstellen.html#cb146-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-9"><a href="daten-darstellen.html#cb146-9" aria-hidden="true" tabindex="-1"></a>chart_overview_summary <span class="ot">&lt;-</span>  chart_overview <span class="sc">%&gt;%</span> </span>
<span id="cb146-10"><a href="daten-darstellen.html#cb146-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(track) <span class="sc">%&gt;%</span> </span>
<span id="cb146-11"><a href="daten-darstellen.html#cb146-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_score =</span> <span class="fu">sum</span>(Score))<span class="sc">%&gt;%</span> </span>
<span id="cb146-12"><a href="daten-darstellen.html#cb146-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(sum_score))</span>
<span id="cb146-13"><a href="daten-darstellen.html#cb146-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-14"><a href="daten-darstellen.html#cb146-14" aria-hidden="true" tabindex="-1"></a>best_songs <span class="ot">&lt;-</span> chart_overview_summary<span class="sc">$</span>track[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb146-15"><a href="daten-darstellen.html#cb146-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-16"><a href="daten-darstellen.html#cb146-16" aria-hidden="true" tabindex="-1"></a>chart_overview <span class="ot">&lt;-</span>  chart_overview <span class="sc">%&gt;%</span> </span>
<span id="cb146-17"><a href="daten-darstellen.html#cb146-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(track <span class="sc">%in%</span> best_songs) <span class="sc">%&gt;%</span> </span>
<span id="cb146-18"><a href="daten-darstellen.html#cb146-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> track,</span>
<span id="cb146-19"><a href="daten-darstellen.html#cb146-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Score)</span>
<span id="cb146-20"><a href="daten-darstellen.html#cb146-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-21"><a href="daten-darstellen.html#cb146-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(chart_overview,<span class="st">&#39;data/chart_top5.csv&#39;</span>)</span>
<span id="cb146-22"><a href="daten-darstellen.html#cb146-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-23"><a href="daten-darstellen.html#cb146-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-24"><a href="daten-darstellen.html#cb146-24" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> temp_covid <span class="sc">%&gt;%</span> </span>
<span id="cb146-25"><a href="daten-darstellen.html#cb146-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(chart_overview, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;calendar_week&#39;</span> <span class="ot">=</span> <span class="st">&#39;kw&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb146-26"><a href="daten-darstellen.html#cb146-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m_temp =</span> m_temp <span class="sc">/</span> <span class="fu">max</span>(m_temp),</span>
<span id="cb146-27"><a href="daten-darstellen.html#cb146-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">new_covid_cases =</span> new_covid_cases <span class="sc">/</span> <span class="fu">max</span>(new_covid_cases)) <span class="sc">%&gt;%</span> </span>
<span id="cb146-28"><a href="daten-darstellen.html#cb146-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb146-29"><a href="daten-darstellen.html#cb146-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;measurement&#39;</span>,</span>
<span id="cb146-30"><a href="daten-darstellen.html#cb146-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>)</span>
<span id="cb146-31"><a href="daten-darstellen.html#cb146-31" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb146-32"><a href="daten-darstellen.html#cb146-32" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb146-33"><a href="daten-darstellen.html#cb146-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="st">&#39;data/darst_aufg_1.csv&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="aufgabe-2-4" class="section level3">
<h3>Aufgabe 2</h3>
<p>Für die Darstellung ist der standardisierte long-Format-Datensatz aus der letzten Aufgabe nötig.</p>
<p>Sollten Sie nicht ganz zum Ende der Aufgabe gekommen sein, können Sie auch den <code>darst_aufg_1.csv</code>-Datensatz einlesen.</p>
<p>Erstellen Sie den folgenden Graphen:</p>
<p><img src="imgs/task_ts.png" width="1000px" style="display: block; margin: auto;" /></p>
<p>Finden Sie dafür im Hilfe-Eintrag der <code>theme</code>- Funktion heraus, wie Sie die Position der Legende verändern können und im Hilfeeintrag der <code>labs</code>-Funktion wie Sie die Beschriftungen anpassen können.</p>
<input type='button' value='Lösung' onclick='showSolution(2);'/>
<div id="solution2" style="visibility:hidden;display:none">
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="daten-darstellen.html#cb147-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb147-2"><a href="daten-darstellen.html#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> calendar_week)) <span class="sc">+</span></span>
<span id="cb147-3"><a href="daten-darstellen.html#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, <span class="at">color =</span> measurement)) <span class="sc">+</span></span>
<span id="cb147-4"><a href="daten-darstellen.html#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>) <span class="sc">+</span></span>
<span id="cb147-5"><a href="daten-darstellen.html#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Kalenderwoche&#39;</span>,</span>
<span id="cb147-6"><a href="daten-darstellen.html#cb147-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;normalisierte Werte&#39;</span>,</span>
<span id="cb147-7"><a href="daten-darstellen.html#cb147-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Covid-Fälle, Temperatur und Spotify-Charts&#39;</span>,</span>
<span id="cb147-8"><a href="daten-darstellen.html#cb147-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Auf ein Maximum von 1 normalisiert&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="aufgabe-3-3" class="section level3">
<h3>Aufgabe 3</h3>
<p>Nutzen Sie den Hilfe-Eintrag der <code>theme</code>-Funktion und der <code>scale_color_manual</code>-Funktion, sowie eine beliebige Anzahl an <code>aesthetics</code>, um den Graph aus der vorigen Aufgabe so sehr zu verunstalten wie Ihnen irgendwie möglich ist.</p>
<input type='button' value='Lösung' onclick='showSolution(3);'/>
<div id="solution3" style="visibility:hidden;display:none">
<p>Mein Vorschlag:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="daten-darstellen.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span>
<span id="cb148-2"><a href="daten-darstellen.html#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="daten-darstellen.html#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>()</span>
<span id="cb148-4"><a href="daten-darstellen.html#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="daten-darstellen.html#cb148-5" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb148-6"><a href="daten-darstellen.html#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> calendar_week)) <span class="sc">+</span></span>
<span id="cb148-7"><a href="daten-darstellen.html#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> value, </span>
<span id="cb148-8"><a href="daten-darstellen.html#cb148-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> measurement, </span>
<span id="cb148-9"><a href="daten-darstellen.html#cb148-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> calendar_week,</span>
<span id="cb148-10"><a href="daten-darstellen.html#cb148-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> calendar_week)) <span class="sc">+</span></span>
<span id="cb148-11"><a href="daten-darstellen.html#cb148-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>,</span>
<span id="cb148-12"><a href="daten-darstellen.html#cb148-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;salmon&#39;</span>),</span>
<span id="cb148-13"><a href="daten-darstellen.html#cb148-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;chartreuse&#39;</span>),</span>
<span id="cb148-14"><a href="daten-darstellen.html#cb148-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>),</span>
<span id="cb148-15"><a href="daten-darstellen.html#cb148-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&#39;pink&#39;</span>),</span>
<span id="cb148-16"><a href="daten-darstellen.html#cb148-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&#39;xkcd&#39;</span>)) <span class="sc">+</span></span>
<span id="cb148-17"><a href="daten-darstellen.html#cb148-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Kalenderwoche&#39;</span>,</span>
<span id="cb148-18"><a href="daten-darstellen.html#cb148-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;normalisierte Werte&#39;</span>,</span>
<span id="cb148-19"><a href="daten-darstellen.html#cb148-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Covid-Fälle, Temperatur und Spotify-Charts&#39;</span>,</span>
<span id="cb148-20"><a href="daten-darstellen.html#cb148-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Auf ein Maximum von 1 normalisiert&#39;</span>) <span class="sc">+</span></span>
<span id="cb148-21"><a href="daten-darstellen.html#cb148-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;pink&#39;</span>, <span class="st">&#39;brown&#39;</span>, <span class="st">&#39;orange&#39;</span>, <span class="st">&#39;green&#39;</span>, <span class="st">&#39;grey&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;white&#39;</span>))</span></code></pre></div>
<pre><code>## Warning: Removed 194 row(s) containing missing
## values (geom_path).</code></pre>
<p><img src="R_Einfuehrung_111220_files/figure-html/unnamed-chunk-123-1.png" width="1000px" style="display: block; margin: auto;" /></p>
</div>

<!-- # --- -->
<!-- # title: "Anhang" -->
<!-- # author: "Max Brede" -->
<!-- # date: "11/12/2020" -->
<!-- # output: -->
<!-- #   ioslides_presentation: -->
<!-- #     transition: faster -->
<!-- #     css: /home/brede/MEGA/Honorar/111220_KfN/styles.css -->
<!-- #     slide_level: 3 -->
<!-- # widescreen: true -->
<!-- # bibliography: /home/brede/MEGA/Honorar/111220_KfN/references.bib -->
<!-- # csl: /home/brede/MEGA/Honorar/111220_KfN/apa.csl -->
<!-- # smaller: true -->
<!-- # --- -->
<!-- ```{r setup 05, include=FALSE} -->
<!-- options(width= 50,align = 'center',tibble.print_max = 10, tibble.print_min = 5) -->
<!-- knitr::opts_chunk$set(fig.align = 'center', message = F, warning = F) -->
<!-- library(tidyverse) -->
<!-- library(knitr) -->
<!-- ## ggplot <- function(...)ggplot2::ggplot(...) +  -->
<!-- ##   theme_minimal(base_size = 8) +  -->
<!-- ##   scale_color_brewer(palette = 'Dark2') + -->
<!-- ##   theme(text = element_text(color = '#797979'), -->
<!-- ##         axis.text = element_text(color = '#797979'), -->
<!-- ##         strip.text = element_text(color = '#797979'), -->
<!-- ##         panel.background = element_rect(fill = "transparent",color = NA),  -->
<!-- ##         plot.background = element_rect(fill = "transparent", color = NA),  -->
<!-- ##         legend.background = element_rect(fill = "transparent", color = NA), -->
<!-- ##         legend.box.background = element_rect(fill = "transparent", color = NA)) -->
<!-- ##  -->
<!-- theme_add <- theme(text = element_text(size = 30)) -->
<!-- ggsave <- function(plot = last_plot(),...)ggplot2::ggsave(plot = plot + theme_add, -->
<!--                                                           ...,bg = 'transparent') -->
<!-- ``` -->
<!-- <!-- ```{r,results='asis', echo = F} -->
<!-- <!-- read_file('/home/brede/MEGA/Honorar/111220_KfN/ioTOC.html') %>% cat -->
<!-- <!-- read_file('/home/brede/MEGA/Honorar/111220_KfN/scrollableSlides.html') %>% cat -->
<!-- <!-- ``` -->
<!-- <!-- ### Ablauf -->
<!-- <!-- <div id="toc"></div> -->
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>Für über eine Übersicht über mehr mögliche geoms lässt sich das <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/master/data-visualization-2.1.pdf">ggplot2-cheatsheet</a> empfehlen.<a href="daten-darstellen.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="daten-einlesen.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R_Einfuehrung_111220.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
